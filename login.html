<!doctype html>
<html>
<body>

<h2>Login com GitHub</h2>
<button id="loginGithub">Login com GitHub</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, GithubAuthProvider, signInWithPopup, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

// Configuração do Firebase
const firebaseConfig = {
  apiKey: "AIzaSyAnTdYwFqsMgKPSlsY8HUnznFJj3zEhn5w",
  authDomain: "contabilidade-flatoutpy.firebaseapp.com",
  projectId: "contabilidade-flatoutpy",
  storageBucket: "contabilidade-flatoutpy.appspot.com",
  messagingSenderId: "540834879646",
  appId: "1:540834879646:web:7528028fdf1378438ac38f",
  measurementId: "G-MZSN6NVK4T"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GithubAuthProvider();

// Botão de login
document.getElementById('loginGithub').onclick = async () => {
  try {
    const result = await signInWithPopup(auth, provider);
    console.log('Usuário logado:', result.user);
    alert(`UID do usuário: ${result.user.uid}\nCopie este UID para usar no ADMIN_UID`);
    // Redireciona para área protegida
    location.href = "/db/";
  } catch (error) {
    console.error('Erro no login:', error);
    alert('Falha no login. Tente novamente.');
  }
};

// Opcional: mostra UID sempre que o usuário já estiver logado
onAuthStateChanged(auth, user => {
  if (user) {
    console.log("Usuário já logado:", user.uid);
  }
});
</script>

</body>
</html>
